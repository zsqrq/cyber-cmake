<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cyber-Cmake: Apollo Cyber RT Developer Tools</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cyber-Cmake
   &#160;<span id="projectnumber">8.0</span>
   </div>
   <div id="projectbrief">Pure Cmake Project For Apollo Cyber Rt</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Apollo Cyber RT Developer Tools </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Apollo Cyber RT framework comes with a collection of useful tools for daily development, including one visualization tool cyber_visualizer and two command line tools cyber_monitor and cyber_recorder.</p>
<p><em>Note: apollo docker environment is required to use the tools, please follow apollo wiki to enter docker</em></p>
<p>All the tools from Apollo Cyber RT rely on Apollo Cyber RT library, so you must source the setup.bash file for environment setup before using any Apollo Cyber RT tools, shown as below:</p>
<div class="fragment"><div class="line">username@computername:~$: source /your-path-to-apollo-install-dir/cyber/setup.bash</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md82"></a>
Cyber_visualizer</h1>
<h2><a class="anchor" id="autotoc_md83"></a>
Install and run</h2>
<p><code>cyber_visualizer</code> is a visualization tool for displaying the channel data in Apollo Cyber RT.</p>
<div class="fragment"><div class="line">username@computername:~$: source /your-path-to-apollo-install-dir/cyber/setup.bash</div>
<div class="line">username@computername:~$: cyber_visualizer</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md84"></a>
Interacting with cyber_visualizer</h2>
<ul>
<li><p class="startli">After launching cyber_visualizer, you will see the following interface:</p>
<p class="startli"><img src="images/cyber_visualizer1.png" alt="interface" class="inline"/></p>
</li>
<li><p class="startli">When data flow through channels in Apollo Cyber RT, the list of all channels are displayed under <code>ChannelNames</code> as seen in the figure below. For example, you can use the record tool(cyber_recorder) of Apollo Cyber RT to replay data from another terminal, then <code>cyber_visualizer</code> will receive information of all active channels(from replay data) and display it.</p>
<p class="startli"><img src="images/cyber_visualizer2.png" alt="channel information" class="inline"/></p>
</li>
<li>By clicking on options in toolbar, you can enable reference grid, display point clouds, add images, or display multiple camera's data at the same time. If you have <code>Show Grid</code> option enabled, you can set the color of the grid by double-clicking the <code>Color</code> item of the <code>Grid</code> list below <code>ChannelNames</code>. The default color is gray. You can also edit the value of <code>CellCount</code> to adjust the number of cells in the grid. As for a point cloud or an image, you can select the source channel through its <code>ChannelName</code> sub-item, and <code>Action</code> sub-item to play or stop the data from the corresponding channel. As shown in figure below, three cameras' channel data on the button sections and one point cloud channel data on the top section are displayed simultaneously. <pre class="fragment">![visualization](images/cyber_visualizer3.png)
</pre></li>
<li><p class="startli">To adjust the virtual camera in the 3D point cloud scene, you can right click on the point cloud display section. A dialog box will pop up as shown in figure below.</p>
<p class="startli"><img src="images/cyber_visualizer4.png" alt="visualization" class="inline"/></p>
<p class="startli">The point cloud scene supports two types of cameras: Free and Target.(select Type from pop up dialog above)</p><ul>
<li><b>Free type Camera</b>: For this type of camera in the point cloud scene, you can change the pose of the camera by holding down either left or right mouse button and move it. To change the pitch of camera, you can scroll the mouse wheel.</li>
<li><b>Target type Camera</b>: For this type of camera in the point cloud scene, to change the camera's viewing angle, you can hold down the left mouse button and then move it. To change the distance of the camera to the observed point (the default observation point is the coordinate system origin (0, 0,0)), you can scroll the mouse wheel.</li>
</ul>
<p class="startli">You can also modify the camera information directly in the dialog box to change the camera's observation status in the point cloud scene. And the "Step" item is the step value from the dialog box.</p>
<p class="startli">Place the mouse on the image of the camera channel, you can double-click the left button to highlight the corresponding data channel on the left menu bar. Right click on the image to bring up menu for deleting the camera channel.</p>
<p class="startli">Play and Pause buttons: when clicking the <code>Play</code> button, all channels will be shown. While when clicking the <code>Pause</code> button, all channels will stop showing on the tool.</p>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md85"></a>
Cyber_monitor</h1>
<h2><a class="anchor" id="autotoc_md86"></a>
Install and run</h2>
<p>The command line tool <code>cyber_monitor</code> provides a clear view of the list of real time channel information Apollo Cyber RT in the terminal.</p>
<div class="fragment"><div class="line">username@computername:~$: source /your-path-to-apollo-install-dir/cyber/setup.bash</div>
<div class="line">username@computername:~$: cyber_monitor</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md87"></a>
Useful commands</h2>
<h3><a class="anchor" id="autotoc_md88"></a>
Display help information</h3>
<p>Use the -h option to get help for cyber_monitor</p>
<div class="fragment"><div class="line">username@computername:~$: cyber_monitor -h</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md89"></a>
Specify the channel</h3>
<p>With the -c option, you can have cyber_monitor to monitor only a specified channel, such as:</p>
<div class="fragment"><div class="line">username@computername:~$: cyber_monitor -c ChannelName</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md90"></a>
Get familiar with UI of cyber_monitor</h1>
<p>After launching the command line tool, you will notice it is similar to cyber_visualizer. It automatically collects the information of all the channels through the topology and displays them in two columns (channel name, channel data type).</p>
<p>The default display for channel information is in red. However, if there is data flowing through the a channel, the corresponding line of the channel is displayed in green. As shown in the image below:</p>
<p><img src="images/cyber_monitor.png" alt="monitor" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md91"></a>
Interacting with cyber_monitor</h2>
<h3><a class="anchor" id="autotoc_md92"></a>
Common commands</h3>
<div class="fragment"><div class="line">ESC | q key ---- Exit</div>
<div class="line">Backspace ---- Back</div>
<div class="line">h | H ---- Show help page</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md93"></a>
Common command for topology and channel</h3>
<div class="fragment"><div class="line">PageDown | Ctrl+d --- Next</div>
<div class="line">PageUp | Ctrl+u --- Previous</div>
<div class="line">Up, down or w, s keys ---- Move the current highlight line up and down</div>
<div class="line">Right arrow or d key ---- Enter highlight line, display highlighted line data in detail</div>
<div class="line">Left arrow or a key ------ Return to the previous layer from the current</div>
<div class="line">Enter key ----- Same as d key</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md94"></a>
Commands only for topology</h3>
<div class="fragment"><div class="line">f | F ----- Display frame rate</div>
<div class="line">t | T ----- Display channel message type</div>
<div class="line">Space ----- Close|Open channel (only valid for channels with data arrival; yellow color after channel is closed)</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md95"></a>
Commands only for channel</h3>
<div class="fragment"><div class="line">i | I ----- Display channel Reader and Writer information</div>
<div class="line">b | B ------ Display channel message content</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md96"></a>
View the repeated data field in a channel</h3>
<div class="fragment"><div class="line">n | N ---- Repeat the next data in the domain</div>
<div class="line">m | M ---- Repeat one data on the domain</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md97"></a>
Cyber_recorder</h1>
<p><code>cyber_recorder</code> is a record/playback tool provided by Apollo Cyber RT. It provides many useful functions, including recording a record file, playing back a record file, splitting a record file, checking the information of record file and etc.</p>
<h2><a class="anchor" id="autotoc_md98"></a>
Install and run</h2>
<p>Launch cyber_recorder:</p>
<div class="fragment"><div class="line">$ source /your-path-to-apollo-install-dir/cyber/setup.bash</div>
<div class="line">$ cyber_recorder</div>
<div class="line">usage: cyber_recorder &lt;command&gt;&gt; [&lt;args&gt;]</div>
<div class="line">The cyber_recorder commands are:</div>
<div class="line">    info                               Show information of an exist record.</div>
<div class="line">    play                               Play an exist record.</div>
<div class="line">    record                             Record same topic.</div>
<div class="line">    split                              Split an exist record.</div>
<div class="line">    recover                            Recover an exist record.</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md99"></a>
Commands of cyber_recorder</h2>
<ul>
<li>To view the information of a record file:</li>
</ul>
<div class="fragment"><div class="line">$ cyber_recorder info -h</div>
<div class="line">usage: cyber_recorder info [options]</div>
<div class="line">    -h, --help              show help message</div>
</div><!-- fragment --><ul>
<li>To record a record file</li>
</ul>
<div class="fragment"><div class="line">$ cyber_recorder record -h</div>
<div class="line">usage: cyber_recorder record [options]</div>
<div class="line">    -o, --output &lt;file&gt;                output record file</div>
<div class="line">    -a, --all                          all channels</div>
<div class="line">    -c, --white-channel &lt;name&gt;         only record the specified channel</div>
<div class="line">    -k, --black-channel &lt;name&gt;         not record the specified channel</div>
<div class="line">    -i, --segment-interval &lt;seconds&gt;   record segmented every n second(s)</div>
<div class="line">    -m, --segment-size &lt;MB&gt;            record segmented every n megabyte(s)</div>
<div class="line">    -h, --help                         show help message</div>
</div><!-- fragment --><ul>
<li>To play back a record file:</li>
</ul>
<div class="fragment"><div class="line">$ cyber_recorder play -h</div>
<div class="line">usage: cyber_recorder play [options]</div>
<div class="line">    -f, --file &lt;file&gt;           input record file</div>
<div class="line">    -a, --all               play all</div>
<div class="line">    -c, --white-channel &lt;name&gt;      only play the specified channel</div>
<div class="line">    -k, --black-channel &lt;name&gt;      not play the specified channel</div>
<div class="line">    -l, --loop              loop play</div>
<div class="line">    -r, --rate &lt;1.0&gt;            multiply the play rate by FACTOR</div>
<div class="line">    -b, --begin &lt;2018-07-01 00:00:00&gt;   play the record begin at</div>
<div class="line">    -e, --end &lt;2018-07-01 00:01:00&gt; play the record end at</div>
<div class="line">    -s, --start &lt;seconds&gt;       play started at n seconds</div>
<div class="line">    -d, --delay &lt;seconds&gt;       play delayed n seconds</div>
<div class="line">    -p, --preload &lt;seconds&gt;     play after trying to preload n second(s)</div>
<div class="line">    -h, --help              show help message</div>
</div><!-- fragment --><ul>
<li>To split a record file:</li>
</ul>
<div class="fragment"><div class="line">$ cyber_recorder split -h</div>
<div class="line">usage: cyber_recorder split [options]</div>
<div class="line">    -f, --file &lt;file&gt;                  input record file</div>
<div class="line">    -o, --output &lt;file&gt;                output record file</div>
<div class="line">    -a, --all                          all channels</div>
<div class="line">    -c, --channel &lt;name&gt;               channel name</div>
<div class="line">    -b, --begin &lt;2018-07-01 00:00:00&gt;  begin at assigned time</div>
<div class="line">    -e, --end &lt;2018-07-01 01:00:00&gt;    end at assigned time</div>
</div><!-- fragment --><ul>
<li>To repair a record file:</li>
</ul>
<div class="fragment"><div class="line">$ cyber_recorder recover -h</div>
<div class="line">usage: cyber_recorder recover [options]</div>
<div class="line">    -f, --file &lt;file&gt;                  input record file</div>
<div class="line">    -o, --output &lt;file&gt;                output record file</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md100"></a>
Examples of using cyber_recorder</h2>
<h3><a class="anchor" id="autotoc_md101"></a>
Check the details of a record file</h3>
<div class="fragment"><div class="line">$ cyber_recorder info demo.record</div>
<div class="line">record_file:    demo.record</div>
<div class="line">version:        1.0</div>
<div class="line">duration:       19.995227 Seconds</div>
<div class="line">begin_time:     2018-04-17 06:25:36</div>
<div class="line">end_time:       2018-04-17 06:25:55</div>
<div class="line">size:           28275479 Bytes (26.965598 MB)</div>
<div class="line">is_complete:    true</div>
<div class="line">message_number: 15379</div>
<div class="line">channel_number: 16</div>
<div class="line">channel_info:   /apollo/localization/pose                             2000 messages : apollo.localization.LocalizationEstimate</div>
<div class="line">                /tf                                                   4000 messages : apollo.transform.TransformStampeds</div>
<div class="line">                /apollo/control                                       2000 messages : apollo.control.ControlCommand</div>
<div class="line">                /apollo/sensor/gnss/odometry                          2000 messages : apollo.localization.Gps</div>
<div class="line">                /apollo/canbus/chassis                                2000 messages : apollo.canbus.Chassis</div>
<div class="line">                /apollo/sensor/gnss/imu                               1999 messages : apollo.drivers.gnss.Imu</div>
<div class="line">                /apollo/sensor/gnss/rtk_obs                             41 messages : apollo.drivers.gnss.EpochObservation</div>
<div class="line">                /apollo/sensor/gnss/ins_stat                            20 messages : apollo.drivers.gnss.InsStat</div>
<div class="line">                /apollo/sensor/gnss/best_pose                           20 messages : apollo.drivers.gnss.GnssBestPose</div>
<div class="line">                /apollo/perception/obstacles                           400 messages : apollo.perception.PerceptionObstacles</div>
<div class="line">                /apollo/prediction                                     400 messages : apollo.prediction.PredictionObstacles</div>
<div class="line">                /apollo/sensor/conti_radar                             270 messages : apollo.drivers.ContiRadar</div>
<div class="line">                /apollo/planning                                       200 messages : apollo.planning.ADCTrajectory</div>
<div class="line">                /apollo/monitor/static_info                              1 messages : apollo.data.StaticInfo</div>
<div class="line">                /apollo/sensor/gnss/rtk_eph                             25 messages : apollo.drivers.gnss.GnssEphemeris</div>
<div class="line">                /apollo/monitor                                          3 messages : apollo.common.monitor.MonitorMessage</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md102"></a>
Record a record file</h3>
<div class="fragment"><div class="line">$ cyber_recorder record -a</div>
<div class="line">[RUNNING]  Record :     total channel num : 1  total msg num : 5</div>
<div class="line">...</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md103"></a>
Replay a record file</h3>
<div class="fragment"><div class="line">$ cyber_recorder play -f 20180720202307.record</div>
<div class="line">file: 20180720202307.record, chunk_number: 1, begin_time: 1532089398663399667, end_time: 1532089404688079759, message_number: 75</div>
<div class="line">please wait for loading and playing back record...</div>
<div class="line">Hit Ctrl+C to stop replay, or Space to pause.</div>
<div class="line">[RUNNING]  Record Time: 1532089404.688080    Progress: 6.024680 / 6.024680</div>
<div class="line">play finished. file: 20180720202307.record</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md104"></a>
rosbag_to_record</h1>
<p><code>rosbag_to_record</code> is a tool which can convert rosbag to recorder file provided by Apollo Cyber RT. Now the tool support following channel:</p>
<div class="fragment"><div class="line">/apollo/perception/obstacles</div>
<div class="line">/apollo/planning</div>
<div class="line">/apollo/prediction</div>
<div class="line">/apollo/canbus/chassis</div>
<div class="line">/apollo/control</div>
<div class="line">/apollo/guardian</div>
<div class="line">/apollo/localization/pose</div>
<div class="line">/apollo/perception/traffic_light</div>
<div class="line">/apollo/drive_event</div>
<div class="line">/apollo/sensor/gnss/odometry</div>
<div class="line">/apollo/monitor/static_info</div>
<div class="line">/apollo/monitor</div>
<div class="line">/apollo/canbus/chassis_detail</div>
<div class="line">/apollo/control/pad</div>
<div class="line">/apollo/navigation</div>
<div class="line">/apollo/routing_request</div>
<div class="line">/apollo/routing_response</div>
<div class="line">/tf</div>
<div class="line">/tf_static</div>
<div class="line">/apollo/sensor/conti_radar</div>
<div class="line">/apollo/sensor/delphi_esr</div>
<div class="line">/apollo/sensor/gnss/best_pose</div>
<div class="line">/apollo/sensor/gnss/imu</div>
<div class="line">/apollo/sensor/gnss/ins_stat</div>
<div class="line">/apollo/sensor/gnss/rtk_eph</div>
<div class="line">/apollo/sensor/gnss/rtk_obs</div>
<div class="line">/apollo/sensor/velodyne64/compensator/PointCloud2</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md105"></a>
Install and run</h2>
<p>Launch rosbag_to_record:</p>
<div class="fragment"><div class="line">$ source /your-path-to-apollo-install-dir/cyber/setup.bash</div>
<div class="line">$ rosbag_to_record</div>
<div class="line">Usage:</div>
<div class="line">  rosbag_to_record input.bag output.record</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md106"></a>
Example</h2>
<p>We can convert <a href="https://github.com/ApolloAuto/apollo/releases/download/v2.5.0/demo_2.5.bag">Apollo2.5 demo bag</a> to record file.</p>
<div class="fragment"><div class="line">$ rosbag_to_record demo_2.5.bag demo.record</div>
<div class="line">record_file:    demo.record</div>
<div class="line">version:        1.0</div>
<div class="line">duration:       19.995227 Seconds</div>
<div class="line">begin_time:     2018-04-17 06:25:36</div>
<div class="line">end_time:       2018-04-17 06:25:55</div>
<div class="line">size:           28275479 Bytes (26.965598 MB)</div>
<div class="line">is_complete:    true</div>
<div class="line">message_number: 15379</div>
<div class="line">channel_number: 16</div>
<div class="line">channel_info:   /apollo/localization/pose                             2000 messages : apollo.localization.LocalizationEstimate</div>
<div class="line">                /tf                                                   4000 messages : apollo.transform.TransformStampeds</div>
<div class="line">                /apollo/control                                       2000 messages : apollo.control.ControlCommand</div>
<div class="line">                /apollo/sensor/gnss/odometry                          2000 messages : apollo.localization.Gps</div>
<div class="line">                /apollo/canbus/chassis                                2000 messages : apollo.canbus.Chassis</div>
<div class="line">                /apollo/sensor/gnss/imu                               1999 messages : apollo.drivers.gnss.Imu</div>
<div class="line">                /apollo/sensor/gnss/rtk_obs                             41 messages : apollo.drivers.gnss.EpochObservation</div>
<div class="line">                /apollo/sensor/gnss/ins_stat                            20 messages : apollo.drivers.gnss.InsStat</div>
<div class="line">                /apollo/sensor/gnss/best_pose                           20 messages : apollo.drivers.gnss.GnssBestPose</div>
<div class="line">                /apollo/perception/obstacles                           400 messages : apollo.perception.PerceptionObstacles</div>
<div class="line">                /apollo/prediction                                     400 messages : apollo.prediction.PredictionObstacles</div>
<div class="line">                /apollo/sensor/conti_radar                             270 messages : apollo.drivers.ContiRadar</div>
<div class="line">                /apollo/planning                                       200 messages : apollo.planning.ADCTrajectory</div>
<div class="line">                /apollo/monitor/static_info                              1 messages : apollo.data.StaticInfo</div>
<div class="line">                /apollo/sensor/gnss/rtk_eph                             25 messages : apollo.drivers.gnss.GnssEphemeris</div>
<div class="line">                /apollo/monitor                                          3 messages : apollo.common.monitor.MonitorMessage</div>
<div class="line">Conversion finished! Took 0.505623051 seconds in total.</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
